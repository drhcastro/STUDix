<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografía: Trastornos Hipertensivos en el Embarazo</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js para gráficas -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- D3.js y TopoJSON para el mapa -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #1e293b;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .country {
            stroke: #f0f4f8;
            stroke-width: 0.5px;
            transition: fill 0.3s ease;
            fill: #cbd5e1; /* Color base para países sin datos */
        }
        .country-highlight {
            fill: #38bdf8; /* Color para países con datos */
        }
        .country:hover {
            fill: #0ea5e9; /* Color al pasar el cursor */
        }
        .tooltip {
            position: absolute;
            text-align: center;
            padding: 8px;
            font-size: 12px;
            background: #1e293b;
            color: white;
            border: 0px;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease-out;
        }
        .btn-filter {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .btn-filter.active {
            background-color: #0ea5e9;
            color: white;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8">
        
        <!-- Encabezado -->
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-sky-700 mb-2">Trastornos Hipertensivos en el Embarazo</h1>
            <p class="text-lg text-slate-600 max-w-3xl mx-auto">Una mirada global a la preeclampsia, el síndrome HELLP y su impacto en la salud materna.</p>
        </header>

        <!-- Sección Principal: Datos Clave -->
        <main>
            <!-- Prevalencia Global -->
            <section class="mb-12">
                 <div class="card p-6 text-center">
                    <h2 class="text-2xl font-bold text-sky-600 mb-2">Prevalencia Mundial de Preeclampsia</h2>
                    <p class="text-5xl font-bold text-slate-800">2% - 8%</p>
                    <p class="text-slate-500 mt-2">de los embarazos a nivel mundial se complican por preeclampsia.</p>
                </div>
            </section>

            <!-- Gráfica y Mapa -->
            <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
                
                <!-- Gráfica Circular -->
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-center mb-4">Mortalidad Materna por Trastornos Hipertensivos</h3>
                    <div class="w-full max-w-sm mx-auto h-64 md:h-72">
                        <canvas id="maternalMortalityChart"></canvas>
                    </div>
                    <div id="chart-buttons" class="flex justify-center flex-wrap gap-2 mt-4">
                        <button data-region="latam" class="btn-filter active text-sm font-semibold bg-slate-200 text-slate-700 py-2 px-4 rounded-full">América Latina y Caribe</button>
                        <button data-region="africa_asia" class="btn-filter text-sm font-semibold bg-slate-200 text-slate-700 py-2 px-4 rounded-full">África y Asia</button>
                        <button data-region="high_income" class="btn-filter text-sm font-semibold bg-slate-200 text-slate-700 py-2 px-4 rounded-full">Países de Altos Ingresos</button>
                    </div>
                </div>

                <!-- Mapa Mundial -->
                <div class="card p-6">
                    <h3 class="text-xl font-bold text-center mb-4">Impacto por Región</h3>
                    <p class="text-center text-sm text-slate-500 mb-2">Pasa el cursor sobre los países/regiones para ver los datos.</p>
                    <div id="map-container" class="relative">
                        <svg id="worldMap" class="w-full h-auto" viewBox="0 0 960 500"></svg>
                    </div>
                </div>
            </section>

            <!-- Estadísticas de EE.UU. y México -->
            <section class="mb-12">
                <h2 class="text-3xl font-bold text-center text-sky-700 mb-8">Estadísticas Clave: EE.UU. y México</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Aumento en EE.UU. -->
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-5xl font-bold text-red-500">25%</span>
                        <p class="mt-2 font-semibold">Aumento en la tasa de preeclampsia en EE.UU. (1987-2004).</p>
                    </div>
                    <!-- Mayor Riesgo -->
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-5xl font-bold text-red-500">6.7x</span>
                        <p class="mt-2 font-semibold">Mayor riesgo de preeclampsia grave en 2003 comparado con 1980 en EE.UU.</p>
                    </div>
                    <!-- Costo Económico -->
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl font-bold text-green-600">$2.18 Mil Millones</span>
                        <p class="mt-2 font-semibold">Costo estimado de la preeclampsia en EE.UU. durante 2012 (primeros 12 meses).</p>
                    </div>
                     <!-- Incidencia en México -->
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl font-bold text-sky-600">47.3 / 1,000</span>
                        <p class="mt-2 font-semibold">Nacimientos es la incidencia de preeclampsia en México.</p>
                    </div>
                    <!-- Síndrome HELLP Global -->
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl font-bold text-orange-500">0.5% - 0.9%</span>
                        <p class="mt-2 font-semibold">De todos los embarazos se complican con Síndrome HELLP.</p>
                    </div>
                    <!-- HELLP y Preeclampsia Grave -->
                    <div class="card p-6 flex flex-col items-center text-center">
                        <span class="text-4xl font-bold text-orange-500">10% - 20%</span>
                        <p class="mt-2 font-semibold">De los casos de preeclampsia grave desarrollan Síndrome HELLP.</p>
                    </div>
                </div>
            </section>
        </main>
        
        <!-- Pie de página -->
        <footer class="text-center mt-12 pt-6 border-t border-slate-300">
            <p class="text-sm text-slate-500">Fuentes: American College of Obstetricians and Gynecologists (ACOG.org) e Instituto Nacional de Perinatología (InPER).</p>
            <p class="text-xs text-slate-400 mt-1">Infografía generada con fines ilustrativos.</p>
        </footer>
    </div>

    <!-- Tooltip para el mapa -->
    <div id="tooltip" class="tooltip"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            // --- LÓGICA DE LA GRÁFICA CIRCULAR (CHART.JS) ---
            const ctx = document.getElementById('maternalMortalityChart').getContext('2d');
            let mortalityChart;

            const data = {
                latam: {
                    labels: ['Trastornos Hipertensivos', 'Otras Causas'],
                    values: [26, 74],
                    title: 'América Latina y Caribe (26%)'
                },
                africa_asia: {
                    labels: ['Trastornos Hipertensivos', 'Otras Causas'],
                    values: [9, 91],
                    title: 'África y Asia (9%)'
                },
                high_income: {
                    labels: ['Trastornos Hipertensivos', 'Otras Causas'],
                    values: [16, 84],
                    title: 'Países de Altos Ingresos (16%)'
                }
            };

            function createOrUpdateChart(region) {
                const regionData = data[region];
                
                if (mortalityChart) {
                    mortalityChart.destroy();
                }

                mortalityChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: regionData.labels,
                        datasets: [{
                            data: regionData.values,
                            backgroundColor: ['#ef4444', '#e5e7eb'], // Rojo para hipertensión, gris para otras
                            borderColor: '#f0f4f8',
                            borderWidth: 4,
                            hoverOffset: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '70%',
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    font: {
                                        family: "'Inter', sans-serif",
                                        size: 12
                                    },
                                    color: '#475569'
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.raw}%`;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Inicializar la gráfica
            createOrUpdateChart('latam');

            // Manejar clics en los botones de filtro
            const buttons = document.querySelectorAll('#chart-buttons button');
            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    buttons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    const region = button.getAttribute('data-region');
                    createOrUpdateChart(region);
                });
            });

            // --- LÓGICA DEL MAPA MUNDIAL (D3.JS) ---
            const width = 960;
            const height = 500;

            const svg = d3.select("#worldMap");
            const tooltip = d3.select("#tooltip");

            const projection = d3.geoMercator()
                .scale(130)
                .center([0, 40])
                .translate([width / 2, height / 2]);

            const path = d3.geoPath().projection(projection);
            
            // Datos para el mapa
            const mapData = {
                'USA': 'EE.UU: Aumento del 25% en preeclampsia (1987-2004).',
                'MEX': 'México: Incidencia de preeclampsia de 47.3 por cada 1,000 nacimientos.',
                'South America': 'América Latina y Caribe: 26% de las muertes maternas por trastornos hipertensivos.',
                'Africa': 'África y Asia: 9% de las muertes maternas por trastornos hipertensivos.',
                'Asia': 'África y Asia: 9% de las muertes maternas por trastornos hipertensivos.',
                'Europe': 'Países de altos ingresos: 16% de las muertes maternas por trastornos hipertensivos.'
            };
            
            // CORRECCIÓN: Se usan los códigos numéricos de los países del archivo TopoJSON
            const countryCodes = {
                '840': 'USA', '484': 'MEX', '124': 'Europe', // USA, Mexico, Canada (as high income)
                // América del Sur
                '032': 'South America', '068': 'South America', '076': 'South America', '152': 'South America', '170': 'South America', '218': 'South America', '328': 'South America', '600': 'South America', '604': 'South America', '740': 'South America', '858': 'South America', '862': 'South America',
                // Caribe y América Central
                '084': 'South America', '188': 'South America', '192': 'South America', '212': 'South America', '214': 'South America', '320': 'South America', '340': 'South America', '332': 'South America', '388': 'South America', '558': 'South America', '591': 'South America', '630': 'South America', '222': 'South America', '304': 'South America',
                // África
                '012': 'Africa', '204': 'Africa', '854': 'Africa', '072': 'Africa', '120': 'Africa', '108': 'Africa', '140': 'Africa', '148': 'Africa', '178': 'Africa', '180': 'Africa', '384': 'Africa', '262': 'Africa', '818': 'Africa', '226': 'Africa', '232': 'Africa', '231': 'Africa', '270': 'Africa', '288': 'Africa', '324': 'Africa', '404': 'Africa', '426': 'Africa', '430': 'Africa', '434': 'Africa', '450': 'Africa', '454': 'Africa', '466': 'Africa', '478': 'Africa', '504': 'Africa', '508': 'Africa', '516': 'Africa', '562': 'Africa', '566': 'Africa', '624': 'Africa', '646': 'Africa', '686': 'Africa', '694': 'Africa', '706': 'Africa', '710': 'Africa', '728': 'Africa', '729': 'Africa', '748': 'Africa', '768': 'Africa', '788': 'Africa', '800': 'Africa', '834': 'Africa', '732': 'Africa', '894': 'Africa', '716': 'Africa',
                // Asia
                '004': 'Asia', '048': 'Asia', '050': 'Asia', '064': 'Asia', '096': 'Asia', '116': 'Asia', '156': 'Asia', '196': 'Asia', '268': 'Asia', '356': 'Asia', '360': 'Asia', '364': 'Asia', '368': 'Asia', '376': 'Asia', '392': 'Asia', '400': 'Asia', '408': 'Asia', '410': 'Asia', '414': 'Asia', '417': 'Asia', '418': 'Asia', '422': 'Asia', '458': 'Asia', '462': 'Asia', '496': 'Asia', '512': 'Asia', '524': 'Asia', '586': 'Asia', '608': 'Asia', '634': 'Asia', '682': 'Asia', '702': 'Asia', '704': 'Asia', '760': 'Asia', '158': 'Asia', '762': 'Asia', '764': 'Asia', '776': 'Asia', '792': 'Asia', '795': 'Asia', '784': 'Asia', '860': 'Asia', '887': 'Asia',
                // Europa (Altos ingresos)
                '276': 'Europe', '250': 'Europe', '040': 'Europe', '056': 'Europe', '203': 'Europe', '191': 'Europe', '208': 'Europe', '233': 'Europe', '246': 'Europe', '300': 'Europe', '348': 'Europe', '352': 'Europe', '372': 'Europe', '380': 'Europe', '428': 'Europe', '442': 'Europe', '528': 'Europe', '578': 'Europe', '616': 'Europe', '620': 'Europe', '642': 'Europe', '643': 'Europe', '703': 'Europe', '705': 'Europe', '724': 'Europe', '752': 'Europe', '756': 'Europe', '804': 'Europe', '826': 'Europe',
                // Oceanía (Altos Ingresos)
                '036': 'Europe', '554': 'Europe'
            };

            d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json").then(world => {
                const countries = topojson.feature(world, world.objects.countries).features;
                
                svg.selectAll("path")
                    .data(countries)
                    .enter().append("path")
                    .attr("d", path)
                    .attr("class", d => {
                        // Asigna la clase 'country' a todos y 'country-highlight' si tiene datos
                        const regionKey = countryCodes[d.id];
                        return 'country ' + (regionKey ? 'country-highlight' : '');
                    })
                    .on("mouseover", function(event, d) {
                        const regionKey = countryCodes[d.id];
                        const tooltipText = mapData[regionKey];
                        
                        if (tooltipText) {
                            tooltip.transition()
                                   .duration(200)
                                   .style("opacity", .9);
                            tooltip.html(tooltipText)
                                   .style("left", (event.pageX + 15) + "px")
                                   .style("top", (event.pageY - 28) + "px");
                        }
                    })
                    .on("mouseout", function() {
                        tooltip.transition()
                               .duration(500)
                               .style("opacity", 0);
                    });
            });
        });
    </script>
</body>
</html>
